name: eidolon
services:
  neo4j:
    image: neo4j:5.25
    environment:
      - NEO4J_AUTH=${NEO4J_USER:-neo4j}/${NEO4J_PASSWORD:-password}
      - NEO4J_dbms_default__database=${NEO4J_DB:-neo4j}
    ports:
      - "7474:7474"
      - "7687:7687"
    volumes:
      - neo4j_data:/data
      - neo4j_logs:/logs
    restart: unless-stopped

  postgres:
    image: postgres:16
    environment:
      - POSTGRES_USER=${POSTGRES_USER:-postgres}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD:-password}
      - POSTGRES_DB=${POSTGRES_DB:-eidolon}
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./eidolon/db/postgres/schema.sql:/docker-entrypoint-initdb.d/schema.sql:ro
    restart: unless-stopped

volumes:
  neo4j_data:
  neo4j_logs:
  postgres_data:
